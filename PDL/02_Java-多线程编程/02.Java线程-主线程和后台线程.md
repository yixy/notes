# Java线程-主线程和守护线程

## 1 主线程

每个Java程序都有一个默认的主线程。Java程序总是从主类的main方法开始执行。当JVM加载代码，发现main方法后就启动一个线程，这个线程就称作"主线程"，该线程负责执行main方法。在main方法中可以再创建其他线程。

## 2 守护线程

守护线程为其它线程的运行提供服务，最典型的例子就是GC线程。**线程可以通过调用setDaemon(true)方法可以转换为守护线程，当进程中不存在非守护线程了，则守护线程自动销毁。**

> 当JVM中没有非守护线程时，守护线程会被自动销毁。

## 3 探讨Java进程的结束：当JVM中没有非守护线程时，守护线程会被自动销毁

如果main方法中没有创建其他线程，那么当main方法返回时JVM就会自动销毁守护线程并结束Java应用程序。但如果main方法中创建了其他线程，那么JVM就要在主线程和其他线程之间轮流切换，保证每个线程都有机会使用CPU资源，main方法返回(主线程结束)JVM也不会结束，要一直等到该程序的main方法创建的所有线程全部结束才自动销毁守护线程并结束Java程序(另外一种情况是：程序中调用了Runtime类的exit方法，并且安全管理器允许退出操作发生。这时JVM也会结束该程序)。

一个典型的例子是使用`ThreadPoolExcuter`启动线程执行任务的场景，即使任务已处理完毕（此时核心线程未被回收），main线程执行完毕也不会导致进程结束。
