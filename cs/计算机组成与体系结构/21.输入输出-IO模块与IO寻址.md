# 输入输出-IO模块与IO寻址 #

**IO设备一般由机械部件（设备本身）和电子部件两部分组成**，为达到模块化和通用性的设计目标，通常将IO设备的机械部件和电子部件分开处理。其中，电子部件又被称为**设备控制器（device controller）**或**适配器（adapter）**，在某些地方也叫做**IO模块**。

## 1 IO模块的功能 ##

IO模块的基本功能是数据缓冲。它还经常负责检错，随后将差错信息报告给处理器。下面是IO模块内外两个层面的连接方式。

1. 通过系统总线或中央交换单元与CPU和主存连接。
2. 通过专用数据线与一个或多个设备相连。

<img src="IO模块通用模型.png" alt="100%" width="100%">

下图用非常通用的术语表示了IO模块的性质。可以看到每个IO模块都有几个寄存器

<img src="IO模块框图.jpeg" alt="100%" width="100%">

下图用非常通用的术语表示了外部设备的性质。

<img src="外部设备通用模型.png" alt="100%" width="100%">

## 2 IO寻址方式 ##

许多IO设备通过IO模块连接到系统，每个设备给出一个唯一标识符或地址。当处理器发送一个IO命令时，该命令包括所需设备地址。因此，每个IO模块必须对地址线译码，确定命令是否发送给自己。

当处理器、主存和IO共享一个公共总线时，可以又两种寻址方式：

**存储映射式寻址（memory-mapped）**：主存单元和IO设备有单一的地址空间，处理器把IO模块的状态，数据寄存器看成存储单元一样对待，并且使用相同机器指令存取主存单元和IO设备。

**分离式寻址（isolated）**：让总线既有存储器读线和写线，也有IO命令线。命令线指定地址是指向主存单元还是指向IO。这样对IO来说，其地址空间与主存是分离的。这种方式下，IO模块上的寄存器也被称为IO端口，CPU通过in/out指令读写端口来进行IO操作。