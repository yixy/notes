# 体系结构的发展3-DLP&TLP&RLP

从 2003 年开始，由于风冷芯片最大功耗和无法有效地开发更多指令级并行这两大瓶颈，单处理器的性能提高速度下降到每年不足 22%。事实上，intel 在 2004年取消了 自己的高性能单核处理器项目，转而和其他公司一起宣布：**为了获得更高性能的处理器，应当提高一个芯片上集成的核心数目，而不是加快单核处理器的速度。**这是一个标志着历史性转折的里程碑信号，**处理器性能的提高从单纯依赖指令级并行(ILP)转向数据级并行（DLP）和线程级并行 （TLP）。**

>1974 年，Robert Dennard 观察到，即使由于每个晶体管的尺寸较小而增加了晶体管的数量，芯片消耗的能量对于给定的硅面积也是恒定的。简而言之：随着给定空间内能够容纳的晶体管的数量不断增加，计算机的速度会越来越快，价格会越来越低。Dennard 缩放在 2004 年左右结束，因为电流和电压无法继续下降并仍然保持集成电路的可靠性。

>1965 年，戈登·摩尔 (Gordon Moore) 著名地预测每个芯片的晶体管数量将每年翻一番，并在 1975 年修改为每两年一次。这一预测持续了大约 50 年，目前已不再成立。

## 1 DLP & TLP & RLP ##

编译器和硬件都是隐式开发 ILP 的，不会引起程序员的注意，而 DLP、TLP和RLP 则是显式并行的，需要调整应用程序的结构才能开发实现并行。在某些情况下，这一调整比较容易，但在大多数情况下，它会成为程序员的主要新增负担。

线程的概念就是程序的执行序，每个执行序有执行上下文需要保存。

* ILP – instruction level parallelism (pipelining)
* DLP – data level parallelism (pipelined arithmetic units, loop unrolling)
* TLP – thread-level processing (using multiple processors/cores)
* RLP – request-level processing (multiple processors/cores plus OS help)。RLP在TLP的基础上加入了操作系统的支持，以更好地利用系统资源。例如，操作系统可以将任务分配给不同的处理器或核心，并管理任务之间的依赖关系和资源竞争。

在超线程技术中，一个物理CPU核心被伪装成两个以上的逻辑CPU核心，看起来就像多个CPU在同时执行任务。这是通过在一个物理核心中创建多个线程实现的，每个线程都有自己的PC寄存器、指令寄存器和条件码寄存器。当线程A的指令停顿的时候，物理CPU核心的译码器和算术逻辑单元（ALU）就会空出来，这时线程B就可以运行自己的指令。这样就可以提高CPU的利用效率。需要注意的是，如果译码器和ALU也是双份的，那么这就是真正的多个CPU核心了，不能称为超线程技术。注意超线程技术与编程语言中的线程是不同层面上的两个东西。本文主要讲解的超线程技术是CPU硬件层面上的概念。而编程中的线程，是操作系统级别的概念，是软件层面上的概念。

> DLP管道化算术单元：在管道化算术单元中，计算单元被设计成能够同时执行多个算术运算。这些运算可以是相互独立的，这样就可以在同一时间周期内处理多个数据元素。例如，一个四级的管道化乘法器可以同时执行多个乘法操作，而不需要等待前一个乘法操作完成。这样，即使在单个时钟周期内，多个乘法操作也可以并行地进行。管道化算术单元的优点是它可以在不增加时钟周期的情况下提高处理器的吞吐量，因为多个操作可以在同一时钟周期内完成。

> DLP循环展开：循环展开是一种通过将循环体中的迭代次数增加到多个的方法来实现数据级并行。这样可以使得每次迭代中处理的数据量增加，从而提高处理器的效率。例如，在一个循环中对一个数组中的元素进行累加操作。通过循环展开，可以使得每次迭代处理多个数组元素，而不是单个元素，从而加快累加的速度。循环展开的优点是它可以减少循环迭代的开销，例如循环控制的开销和循环结束条件的判断。这样可以提高处理器的效率。

矢量计算机（Vector Computer）：矢量处理技术也在视频游戏控制台硬件和图形加速器中运行。

人工智能加速器（英語：AI accelerator）是一类专用于人工智能（特别是人工神经网络、机器视觉、机器学习等）硬件加速的微处理器或计算系统。

DSA（Domain Specific Architecture，特定领域架构）。意思是说，未来需要面向不同的场景，需要根据场景的特点，去定制芯片。

## 2 CA在不同时代的研究侧重点 ##

| Ages  | Key Research Scopes                       | Sample Computers            |
|-------|-------------------------------------------|-----------------------------|
| 1940s | Stored-program computer                   | ENIAC, EDVAC                |
| 1960s | Instruction Set                           | IBM 360                     |
| 1970s | Pipeline, Vector Computer, Microprocessor | Cray-1, Intel 4004          |
| 1980s | RISC, Cache, Pipeline                     | MIPS R1000, POWER           |
| 1990s | SMP, CMP, Instruction-Level Parallelism   | MIPS R10000, PowerPC 604    |
| 2000s | SMT, Power Consumption, Multicore         | Intel i7, Power 6, ARM, GPU |
| 2020s | AI Accelerator. DSA                       | GPU, NPU                    |

